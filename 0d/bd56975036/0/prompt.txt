I opened a PR and there's some feedback to address:

---

* The JSONLContent function only handles JSON objects by unmarshaling into map[string]any. If a JSONL line contains a top-level JSON array (which is valid JSONL), the unmarshal fails and the line is written unchanged without any secret redaction. While nested arrays within objects are correctly walked by collectJSONLReplacements, top-level arrays like ["secret-api-key-12345"] would pass through unredacted.  Let's add unit tests for that case, too.

* In jsonEncodeString we're returning an empty string if JSON encoding fails.  I think we should error out in this situation.  Change the signature to return (string, error) and handle appropriately by stopping what was happening with an error.

* Add test coverage for the field skipping logic (shouldSkipJSONLField). Currently there are no tests verifying that fields ending in "id", "ids", or the exact field "signature" are properly skipped during redaction. This is critical functionality because incorrectly redacting these fields could break checkpoint metadata (e.g., session_id, checkpoint_id) or legitimate signatures.

* Add test coverage for the image object skipping logic (shouldSkipJSONLObject). There are no tests verifying that JSON objects with "type":"image" are properly skipped during redaction. This is important because image data (like base64-encoded images) might have high entropy and should not be redacted.